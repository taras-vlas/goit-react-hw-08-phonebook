(this["webpackJsonpgoit-react-hw-08-phonebook"]=this["webpackJsonpgoit-react-hw-08-phonebook"]||[]).push([[1],{137:function(e,t,n){"use strict";n.r(t);var c=n(23),o=n(29),i=n(6),r=n(44),s=n(73),a=(n(62),n(0)),u=n.n(a),l=n(18),d=n(31),h=n(32),g=[{path:"/contacts",label:"Contacts Page",component:Object(a.lazy)((function(){return n.e(0).then(n.bind(null,174))})),exact:!0,isProtected:!0}],j=n(164),f=n(30),b=n.n(f),O=n(37),p=Object(O.c)({name:"user",initialState:{email:"",name:"",token:"",isLoggedOn:!1,isLoading:!0,isAuthorized:!0,error:""},reducers:{fetchRegisterRequest:function(e){e.isLoading=!0},fetchRegisterSuccess:function(e,t){e.name=t.payload.user.name,e.email=t.payload.user.email,e.token=t.payload.token,e.isLoggedOn=!1,e.isLoading=!1},fetchRegisterError:function(e,t){e.error=t.payload.message,e.isLoading=!1},fetchLoginRequest:function(e){e.isLoading=!0},fetchLoginSuccess:function(e,t){e.name=t.payload.user.name,e.email=t.payload.user.email,e.token=t.payload.token,e.isLoggedOn=!1,e.isLoading=!1},fetchLoginError:function(e,t){e.error=t.payload.message,e.isLoading=!1},fetchLogoutRequest:function(e){e.isLoading=!0},fetchLogoutSuccess:function(e,t){e.token="",e.name="",e.email="",e.isLoggedOn=!1,e.isLoading=!1},fetchLogoutError:function(e,t){e.error=t.payload,e.isLoading=!1},fetchUserRequest:function(e){e.isAuthorized=!0},fetchUserSuccess:function(e,t){e.name=t.payload.name,e.email=t.payload.email,e.isLoggedOn=!0,e.isAuthorized=!1},fetchUserError:function(e){e.isAuthorized=!1,e.isLoggedOn=!1,e.token=""},fetchUserCancel:function(e){e.isAuthorized=!1}}}),m=p.actions,L=p.reducer,x=(m.fetchRegisterRequest,m.fetchRegisterSuccess,m.fetchRegisterError,m.fetchLoginRequest,m.fetchLoginSuccess,m.fetchLoginError,m.fetchLogoutRequest),k=m.fetchLogoutSuccess,y=m.fetchLogoutError,v=m.fetchUserRequest,R=m.fetchUserSuccess,E=m.fetchUserError,S=m.fetchUserCancel,C=L;b.a.defaults.baseURL="https://connections-api.herokuapp.com/users";var N=function(e){b.a.defaults.headers.common.Authorization=e},z=n(166),A=n(168),U=n(59),q=Object(U.a)({menu:{},link:{color:"green"},container:{display:"flex",justifyContent:"space-between"},button:{width:"150px",height:"25px"},active:{color:"rgb(59, 138, 255)"}}),w=n(4),T=function(){var e=q(),t=Object(l.b)(),n=Object(l.c)((function(e){return e.user.isLoggedOn})),c=u.a.useState(null),i=Object(h.a)(c,2),r=i[0],s=i[1],a=function(){s(null)};return Object(w.jsxs)("div",{className:e.container,children:[Object(w.jsx)(j.a,{"aria-controls":"simple-menu","aria-haspopup":"true",onClick:function(e){s(e.currentTarget)},children:"Open Menu"}),Object(w.jsx)(z.a,{id:"simple-menu",anchorEl:r,keepMounted:!0,open:Boolean(r),onClose:a,className:e.menu,children:g.map((function(t){var c=t.path,i=t.exact,r=t.label,s=t.isProtected,u=t.isNotLoggedOn;return function(e,t,n){return(!e||e&&t)&&(!n||n&&!t)}(s,n,u)?Object(w.jsx)(A.a,{onClick:a,children:Object(w.jsx)(o.b,{activeClassName:e.active,exact:i,to:c,children:r},c)}):null}))}),Object(w.jsx)(j.a,{onClick:function(){return t((function(e,t){e(x()),b.a.post("/logout").then((function(){return e(k())})).catch((function(t){d.b.error(t.message),e(y(t.message))}))}))},className:e.button,variant:"contained",color:"primary",children:"Logout"})]})},B=n(10),P=function(e){return Object(l.c)((function(e){return e.user.isLoggedOn}))?Object(w.jsx)(B.b,Object(c.a)({},e)):Object(w.jsx)(B.a,{to:"/login"})},F=function(e){var t=Object(l.c)((function(e){return e.user.isLoggedOn})),n=e.isNotLoggedOn;return!n||n&&!t?Object(w.jsx)(B.b,Object(c.a)({},e)):null},M=n(76),J=n.n(M),I=function(){return Object(w.jsx)("div",{className:"content",children:Object(w.jsx)(a.Suspense,{fallback:Object(w.jsx)(J.a,{type:"TailSpin",color:"#00BFFF",height:40,width:40,className:"Spinner",timeout:3e3}),children:Object(w.jsx)(B.d,{children:g.map((function(e){var t=e.path,n=e.exact,c=e.isProtected,o=e.component,i=e.isNotLoggedOn;return c?Object(w.jsx)(P,{path:t,exact:n,component:o},t):Object(w.jsx)(F,{path:t,exact:n,component:o,isNotLoggedOn:i},t)}))})})})},_=function(){var e=Object(l.b)(),t=Object(l.c)((function(e){return e.user.isAuthorized}));return Object(a.useEffect)((function(){e((function(e,t){var n=t().user.token;n?(e(v()),N(n),b.a.get("/current").then((function(t){var n=t.data;return e(R(n))})).catch((function(t){d.b.error(t.message),N(""),e(E(t.message))}))):e(S())}))}),[e]),Object(w.jsx)("div",{children:t?Object(w.jsx)("p",{children:"isLoading..."}):Object(w.jsxs)("div",{className:"body",children:[Object(w.jsx)(T,{}),Object(w.jsx)(I,{}),Object(w.jsx)(d.a,{})]})})},D=n(77),G=n(22),H=n(25),K=n(14),Q=n(78),V={key:"token",storage:n.n(Q).a},W=Object(H.g)(V,C),X=Object(K.b)({user:W}),Y=n(79),Z=n.n(Y),$=[].concat(Object(G.a)(Object(O.d)({serializableCheck:{ignoredActions:[H.a,H.f,H.b,H.c,H.d,H.e]}})),[Z.a]),ee=Object(O.a)({reducer:X,middleware:$,devTools:!1}),te=Object(H.h)(ee),ne={position:r.b.BOTTOM_CENTER,timeout:5e3,offset:"30px",transition:r.c.SCALE},ce=function(){return Object(w.jsx)(r.a,Object(c.a)(Object(c.a)({template:s.a},ne),{},{children:Object(w.jsx)(l.a,{store:ee,children:Object(w.jsx)(D.a,{loading:null,persistor:te,children:Object(w.jsx)(o.a,{children:Object(w.jsx)(_,{})})})})}))};Object(i.render)(Object(w.jsx)(ce,{}),document.getElementById("root"))},62:function(e,t,n){}},[[137,2,3]]]);
//# sourceMappingURL=main.b89f51ed.chunk.js.map